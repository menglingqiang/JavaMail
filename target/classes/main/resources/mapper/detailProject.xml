<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="main.java.com.seckill.dao.DetailProjectDao">

	<resultMap type="main.java.com.seckill.entity.DetailProject" id="detailProjectResultMap">  
        <id column="project_detail_id" property="projectDetailId"/>  
        <result column="project_detail_name" property="projectDetailName"/>  
        <result column="detail_start_time" property="detailStartTime"/>  
        <result column="detail_end_time" property="detailEndTime"/>  
        <result column="detail_modify" property="detailModify"/>  
        <result column="done" property="done"/>  
        <association property="project" javaType="main.java.com.seckill.entity.Project">  
            <id column="project_id" property="projectId"/>  
	        <result column="project_name" property="projectName"/>  
	        <result column="start_time" property="startTime"/>  
	        <result column="end_time" property="endTime"/>  
	        <result column="modify" property="modify"/>    
        </association> 
    </resultMap> 
    
    <select id="queryAllDetailProject" resultMap="detailProjectResultMap">
    	select *
    	from user_detail_info
    </select>
    
    <insert id="addDetailProject" parameterType="main.java.com.seckill.entity.DetailProject">
    	INSERT INTO user_detail_info
    	(project_id, project_detail_name, detail_start_time, detail_end_time) 
		VALUES(#{projectId}, #{projectDetailName},#{detailStartTime} ,#{detailEndTime} )
    </insert>
    
    <delete id="deteleDetailProject" parameterType="java.lang.Long">
    	delete from user_detail_info
    	where project_dedtail_id=#{projectDetailId}
    </delete>
    
    <!-- 后期换成动态sql -->
    <update id="modifyDetailProject" parameterType="main.java.com.seckill.entity.DetailProject">
    	update user_detail_info
    	set project_detail_name=#{projectDetailName},detail_start_time=#{detailStartTime},
    	detail_end_time=#{detailEndTime},detail_modify = detail_modify+1
    	where project_detail_id=#{projectDetailId}
    </update>
    
    <update id="modifyDetailProjectForDone" parameterType="java.lang.Long">
    	update user_detail_info
    	set done=1
    	where project_detail_id=#{projectDetailId}
    </update>
    
</mapper>

