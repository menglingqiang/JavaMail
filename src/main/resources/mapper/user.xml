<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="main.java.com.seckill.dao.UserDao">

	<select id="queryAllUser" resultType="main.java.com.seckill.entity.User">
		select user_id,name,password,email,code,status,create_time
		from user
	</select>
    <select id="queryByCode" parameterType="string" resultType="main.java.com.seckill.entity.User">
    	select user_id,name,password,email,code,status,create_time
    	from user where code=#{code}
    </select>
    
    <select id="queryByPassword" parameterType="main.java.com.seckill.entity.User" resultType="main.java.com.seckill.entity.User">
    	select user_id,name,password,email,code,status,create_time
    	from user where email = #{email} and password = #{password}
    </select>
    
     <select id="queryByEmail" parameterType="main.java.com.seckill.entity.User" resultType="main.java.com.seckill.entity.User">
    	select user_id,name,password,email,code,status,create_time,user_pic
    	from user where email = #{email}
    </select>
	
	<insert id="register" parameterType="main.java.com.seckill.entity.User" >
	
		INSERT INTO user(name, password, email, code, status, create_time,user_pic) 
		VALUES(#{name}, #{password}, #{email}, #{code}, 0, #{createTime},'userdefault.jpg')
	</insert>
	
	<update id="UpdateUserByCode" parameterType="string">
		UPDATE user 
		SET  status=1
		,code = null
		where code = #{code}
	</update>
	
	<update id="updateUser" parameterType="main.java.com.seckill.entity.User">
		UPDATE user 
		<set>

	        <if test="password!=null and !&quot;&quot;.equals(password.trim())">
	  			password=#{password},
		    </if>
		    <if test="password!=null and !&quot;&quot;.equals(password.trim())">
	  			name=#{name},
		    </if>
		    <if test="userPic!=null and !&quot;&quot;.equals(userPic.trim())">
	  			user_pic=#{userPic},
	    </if>

        </set>
		where email = #{email}
	</update>
	
</mapper>

